## [ë°‘ë°”ë‹¥ë¶€í„° ì‹œìž‘í•˜ëŠ” ë”¥ëŸ¬ë‹]
---
### ëª©ì°¨
- []()
---
#### CHAPTER6_í•™ìŠµ ê´€ë ¨ ê¸°ìˆ ë“¤
---
> #### 6.1 ë§¤ê°œë³€ìˆ˜ ê°±ì‹ 
> í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(SGD)
> - ë§¤ê°œë³€ìˆ˜ì˜ ê¸°ìš¸ê¸°(ë¯¸ë¶„)ì„ êµ¬í•´ ê¸°ìš¸ì–´ì§„ ë°©í–¥ìœ¼ë¡œ ë§¤ê°œë³€ìˆ˜ ê°’ì„ ê°±ì‹ í•˜ëŠ” ì¼ì„ ë°˜ë³µí•˜ì—¬ ì ì  ìµœì ì˜ ê°’ì— ë‹¤ê°€ê°€ëŠ” ë°©ë²•
> 
> ì§€ê¸ˆê¹Œì§€ëŠ” SGDë¥¼ ì´ìš©í–ˆì§€ë§Œ ì´ì œ SGDì˜ ë‹¨ì ì„ ì•Œì•„ë³´ê³  SGDì™€ ë‹¤ë¥¸ ìµœì í™” ê¸°ë²•ì„ í•™ìŠµí•œë‹¤.
> 
> #### 6.1.1 ëª¨í—˜ê°€ ì´ì•¼ê¸°
> ìµœì í™” í•´ì•¼í•˜ëŠ” ìƒí™©ì„ ëª¨í—˜ê°€ì— ë¹„ìœ í•œë‹¤.
> 
>> ì„¸ìƒì—ì„œ ê°€ìž¥ ê¹Šê³  ë‚®ì€ ê³¨ì§œê¸°ì¸ 'ê¹Šì€ ê³³'ì„ ì°¾ì•„ ê°€ë ¤í•œë‹¤ í•˜ì§€ë§Œ 2ê°€ì§€ì˜ ì œì•½ì´ ìžˆë‹¤. 'ì§€ë„ë¥¼ ë³´ì§€ ì•ŠëŠ”ê²ƒ' ê³¼ 'ëˆˆê°€ë¦¬ê°œë¥¼ ì“°ëŠ” ê²ƒ' ì´ë‹¤.
>> 
>> ì´ëŸ¬í•œ ì œì•½ ì¡°ê±´ì´ ìžˆì„ ë•Œ ì´ ëª¨í—˜ê°€ëŠ” ì–´ë–»ê²Œ 'ê¹Šì€ ê³³'ì„ ì°¾ì•„ ê°ˆ ìˆ˜ ìžˆì„ê¹Œ ì–´ë–¨ê²Œ ê±¸ìŒì„ ì˜®ê²¨ì•¼ íš¨ìœ¨ì ìœ¼ë¡œ 'ê¹Šì€ ê³³'ì„ ì°¾ì•„ ë‚¼ ìˆ˜ ìžˆì„ ê²ƒì¸ê°€?
>
> ìœ„ ìƒí™©ê³¼ ìš°ë¦¬ì˜ ìƒí™©ì€ ë¹„ìŠ·í•˜ë‹¤ ë˜í•œ ìœ„ì˜ ìƒí™©ì—ì„œ ê°€ìž¥ ì¤‘ìš”í•œ ë‹¨ì„œê°€ ë˜ëŠ” ê²ƒì€ 'ê¸°ìš¸ê¸°'ë‹¤.
> 
> ì£¼ìœ„ì˜ ì‹œê°ì ì¸ ì •ë³´ë¥¼ ìŠµë“ í•  ìˆ˜ ì—†ì§€ë§Œ ì„œìžˆëŠ” ë•…ì˜ ê¸°ìš¸ê¸°ëŠ” ì•Œ ìˆ˜ ìžˆë‹¤.
> 
> ì´ë•Œ ì§€ê¸ˆ ì„œìžˆëŠ” ìž¥ì†Œì—ì„œ ê°€ìž¥ í¬ê²Œ ê¸°ìš¸ì–´ì§„ ë°©í–¥ìœ¼ë¡œ ê°€ëŠ” ê²ƒì´ SGDì˜ ì „ëžµì´ë‹¤.
> 
> #### 6.1.2 í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(SGD)
> SGDëŠ” ìˆ˜ì‹ìœ¼ë¡œëŠ” ì•„ëž˜ì™€ ê°™ë‹¤. 
>
> ![6_1ì‹](./image/06/6_1ì‹.png)
> 
> ì‹¤ì œë¡œ í•™ìŠµë¥ ì€ 0.01ì´ë‚˜ 0.001ê³¼ ê°™ì€ ê°’ì„ ë¯¸ë¦¬ ì •í•´ì„œ ì‚¬ìš©í•˜ë©° 'â†' ëŠ” ìš°ë³€ì˜ ê°’ì„ ì¢Œë³€ì˜ ê°’ìœ¼ë¡œ ê°±ì‹ í•œë‹¤ëŠ” ëœ»ì´ë‹¤.
> 
> ìœ„ ì‹ì—ì„œ ë³´ë“¯ SGDëŠ” ê¸°ìš¸ì–´ì§„ ë°©í–¥ìœ¼ë¡œ ì¼ì • ê±°ë¦¬ë§Œ ê°€ê² ë‹¤ëŠ” ë‹¨ìˆœí•œ ë°©ë²•ì´ë‹¤.
> 
> ì•„ëž˜ëŠ” íŒŒì´ì¬ì„ ì´ìš©í•´ SGDë¥¼ êµ¬í˜„í•œ ì½”ë“œë‹¤.
> 
> ```Python
> class SGD:
>     def __init__(self, lr = 0.01):
>         self.lr = lr
>     
>     def update(self, params, grads):
>         for key in params.keys():
>             params[key] -= self.lr * grads[key]
> ```
> ì´ˆê¸°í™” ë•Œ ë°›ëŠ” ì¸ìˆ˜ì¸ lrì€ learning rate(í•™ìŠµë¥ )ì„ ëœ»í•œë‹¤. ì´ í•™ìŠµë¥ ì€ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ìœ ì§€í•œë‹¤.
> 
> update(params, grads)ë©”ì„œë“œëŠ” SDGê³¼ì •ì—ì„œ ë°˜ë³µí•´ì„œ í˜¸ì¶œëœë‹¤. ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì¸ params, gradsëŠ” ë”•ì…”ë„ˆë¦¬ ë³€ìˆ˜ë‹¤.
> 
> params['W1'], grads['W1']ê³¼ ê°™ì´ ê°ê°ì˜ ê°€ì¤‘ì¹˜ ë§¤ê°œë³€ìˆ˜ì™€ ê¸°ìš¸ê¸°ë¥¼ ì €ìž¥í•˜ê³  ìžˆë‹¤.
> 
> SGDí´ëž˜ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ ì‹ ê²½ë§ ë§¤ê°œ ë³€ìˆ˜ì˜ ì§„í–‰ì„ ì•„ëž˜ì™€ ê°™ì´ ìˆ˜í–‰í•  ìˆ˜ ìžˆë‹¤.
> ```Python
> network = TwoLayerNet(...)
> optimizer = SGD() #SGD ì‚¬ìš©
> for i in range(10000):
>     ...
>     x_batch, t_batch = get_mini_batch(...) #ë¯¸ë‹ˆë°°ì¹˜
>     grads = network.gradient(x_batch, t_batch)
>     params = network.parmas
>     optimizer.update(params, grads)
>     ...
> ```
> optimizerëŠ” 'ìµœì í™”ë¥¼ í–‰í•˜ëŠ” ìž'ë¼ëŠ” ëœ»ì˜ ë‹¨ì–´ì´ë©° ìœ„ ì½”ë“œì—ì„  SGDê°€ ê·¸ ì—­í• ì„ í•œë‹¤.
> 
> ë§¤ê°œë³€ìˆ˜ ê°±ì‹ ì€ optimizerê°€ ìˆ˜í–‰í•˜ë¯€ë¡œ optimizerì— ë§¤ê°œë³€ìˆ˜ ê¸°ìš¸ê¸° ì •ë³´ë§Œ ë„˜ê²¨ì£¼ë©´ ëœë‹¤.
> 
> ì´ì™€ê°™ì´ ìµœì í™”ë¥¼ ë‹´ë‹¹í•˜ëŠ” í´ëž˜ìŠ¤ë¥¼ ë¶„ë¦¬í•´ êµ¬í˜„í•˜ë©´ ê¸°ëŠ¥ì„ ëª¨ë“ˆí™” í•˜ê¸° ì¢‹ë‹¤.
> - ì„ ì–¸í• ë•Œë§Œ ```optimizer = SGD()```ì—ì„œ ```optimizer = ì‚¬ìš©í•  í´ëž˜ìŠ¤``` ì˜ ë°©ì‹ìœ¼ë¡œ ë°”ê¿” ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. 
> 
> #### 6.1.3 SGDì˜ ë‹¨ì 
> ë‹¤ìŒ í•¨ìˆ˜ì˜ ìµœì†Ÿê°’ì„ êµ¬í•˜ëŠ” ë¬¸ì œë¥¼ í‘¼ë‹¤.
> 
> ![ë¹„ë“±ë°©ì„±í•¨ìˆ˜](./image/06/ë¹„ë“±ë°©ì„±í•¨ìˆ˜.png)
> 
>  SGDë¥¼ ì´ìš©í•œë‹¤ë©´ ê²°ê³¼ëŠ” ì•„ëž˜ì™€ ê°™ì´ ì‹¬í•˜ê²Œ êµ½ì–´ì§„(ì§€ê·¸ìž¬ê·¸ê°€ ì‹¬í•œ)ëª¨ìŠµì„ ë³´ì¸ë‹¤.
>
> ![SGD_img](./image/06/SGD_img.png) 
>
> SGDí•¨ìˆ˜ì˜ ê°€ìž¥ í° ë‹¨ì ì€ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ë¹„ë“±ë°©ì„± í•¨ìˆ˜(ë°©í–¥ì— ë”°ë¼ ì„±ì§ˆ, ì—¬ê¸°ì„  ê¸°ìš¸ê¸°ê°€ ë‹¬ë¼ì§€ëŠ” í•¨ìˆ˜)ì—ì„œëŠ” íƒìƒ‰ ê²½ë¡œê°€ ë¹„íš¨ìœ¨ì ì´ê¸° ë•Œë¬¸ì´ë‹¤.
> 
> ì´ëŸ´ ë•Œì—ëŠ” SGDê°™ì´ ë¬´ìž‘ì • ê¸°ìš¸ì–´ì§„ ë°©í–¥ìœ¼ë¡œ ì§„í–‰í•˜ëŠ” ë‹¨ìˆœí•œ ë°©ì‹ë§ê³  ë‹¤ë¥¸ ë°©ì‹ì´ í•„ìš”í•´ì§„ë‹¤.
> - ëª¨ë©˜í…€, AdaGrad, Adamë“±
> 
> #### 6.1.4 ëª¨ë©˜í…€
> ëª¨ë©˜í…€ì€ ìš´ë™ëŸ‰ì„ ëœ»í•˜ëŠ” ë‹¨ì–´ë¡œ ë¬¼ë¦¬ì™€ ê´€ê³„ê°€ ìžˆìœ¼ë©° ì‹ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ì•„ëž˜ì™€ ê°™ë‹¤.
> 
> ![ëª¨ë©˜í…€](./image/06/ëª¨ë©˜í…€.png)
> 
> ìœ„ ì‹ì€ ê¸°ìš¸ê¸° ë°©í–¥ìœ¼ë¡œ íž˜ì„ ë°›ì•„ ë¬¼ì²´ê°€ ê°€ì†ëœë‹¤ëŠ” ë¬¼ë¦¬ ë²•ì¹™ì„ ë‚˜íƒ€ë‚´ë©° ê³µì´ ê·¸ë¦‡ì˜ ë°”ë‹·ì„ êµ¬ë¥´ëŠ” ë“¯í•œ ì›€ì§ìž„ì„ ë³´ì—¬ì¤€ë‹¤.
> 
> ![ëª¨ë©˜í…€_2](./image/06/ëª¨ë©˜í…€_2.png)
> 
> ë˜í•œ ìœ„ ì‹ì—ì„œ ð›¼ví•­ì€ ë¬¼ì œê°€ ì•„ë¬´ëŸ° íž˜ì„ ë°›ì§€ ì•Šì„ ë•Œ ì„œì„œížˆ í•˜ê°•ì‹œí‚¤ëŠ” ì—­í• ì„ í•œë‹¤(ð›¼ëŠ” 0.9ë“±ì˜ ê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤). ë¬¼ë¦¬ì—ì„œ ì§€ë©´ì˜ ë§ˆì°°ì´ë‚˜ ê³µê¸°ì˜ ì €í•­ì— í•´ë‹¹í•œë‹¤.
> 
> ì•„ëž˜ ì½”ë“œëŠ” ëª¨ë©˜í…€ì˜ êµ¬í˜„ì´ë‹¤. 
> ```Python
> class Momentum:
>     def __init__(self, lr=0.01, momentum=0.9):
>         self.lr = lr
>         self.momentum = momentum
>         self.v = None # ë¬¼ì²´ì˜ ì†ë„
>         
>     def update(self, params, grads):
>         if self.v is None:
>             self.v = {} # ì´ˆê¸°í™” ì‹œì—” Noneë¡œ ì´ˆê¸°í™” í•œ ë’¤ ì²˜ìŒ í˜¸ì¶œë  ë•Œ ë§¤ê°œ ë³€ìˆ˜ì™€ ê°™ì€ êµ¬ì¡°ì˜ ë°ì´í„°ë¥¼ ë”•ì…”ë„ˆë¦¬ ë³€ìˆ˜ë¡œ ì €ìž¥í•œë‹¤.
>             for key, val in params.items():                                
>                 self.v[key] = np.zeros_like(val)
>                 
>         for key in params.keys():
>             self.v[key] = self.momentum*self.v[key] - self.lr*grads[key] 
>             params[key] += self.v[key]
> ```
> ì´ì œ ëª¨ë©˜í…€ì„ ì´ìš©í•´ í’€ë©´ ì•„ëž˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.
> 
> ![ëª¨ë©˜í…€_img](./image/06/ëª¨ë©˜í…€_img.png)
> 
> ê·¸ë¦¼ì—ì„œ ë³´ë“¯ ëª¨ë©˜í…€ì˜ ê°±ì‹  ê²½ë¡œëŠ” SGDì— ë¹„í•´ ì§€ê·¸ìž¬ê·¸ ì •ë„ê°€ ëœí•˜ë©° ê·¸ë¦‡ ë°”ë‹¥ì„ êµ¬ë¥´ë“¯ ì›€ì§ì´ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìžˆë‹¤.
> 
> ì´ëŠ” xì¶•ì˜ íž˜ì€ ì•„ì£¼ ìž‘ì§€ë§Œ ë°©í–¥ì€ ë³€í•˜ì§€ ì•Šì•„ì„œ í•œ ë°©í–¥ìœ¼ë¡œ ì¼ì •í•˜ê²Œ ê°€ì†í•˜ê¸° ë•Œë¬¸ì´ë‹¤. 
> 
> ê·¸ ë°˜ëŒ€ë¡œ yì¶•ì˜ íž˜ì€ í¬ì§€ë§Œ ìœ„ì•„ëž˜ë¡œ ë²ˆê°ˆì•„ ë°›ì•„ ìƒì¶©í•˜ì—¬ yì¶• ë°©í–¥ì˜ ì†ë„ëŠ” ì•ˆì •ì ì´ì§€ ì•Šë‹¤.
> 
> ì „ì²´ì ìœ¼ë¡œëŠ” SGDë³´ë‹¤ xì¶• ë°©í–¥ìœ¼ë¡œ ë¹ ë¥´ê²Œ ë‹¤ê°€ê°€ ì§€ê·¸ìž¬ê·¸ ì›€ì§ìž„ì´ ì¤„ì–´ë“ ë‹¤.
> 
> #### 6.1.5 AdaGrad
> ì‹ ê²½ë§ í•™ìŠµì—ì„  í•™ìŠµë¥  ê°’ì´ ì¤‘ìš”í•˜ë‹¤. ê°’ì´ ë„ˆë¬´ ìž‘ìœ¼ë©´ í•™ìŠµ ì‹œê°„ì´ ë§¤ìš° ê¸¸ì–´ì§€ê³  ë„ˆë¬´ í¬ë©´ í•™ìŠµì´ ì œëŒ€ë¡œ ì´ë£¨ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤.
> 
> í•™ìŠµë¥ ì„ ì •í•˜ëŠ” íš¨ê³¼ì  ê¸°ìˆ ë¡œ **í•™ìŠµë¥  ê°ì†Œ**ê°€ ìžˆë‹¤. 
> 
> í•™ìŠµì„ ì§„í–‰í•˜ë©´ì„œ í•™ìŠµë¥ ì„ ì ì°¨ ì¤„ì—¬ê°€ëŠ” ë°©ë²•ì´ë‹¤
> - ì²˜ìŒì—” í¬ê²Œ í•™ìŠµí•˜ë‹¤ ì¡°ê¸ˆì‹ ìž‘ê²Œ í•™ìŠµí•˜ëŠ” ë°©ì‹ì´ë©° ì‹¤ì œ ì‹ ê²½ë§ í•™ìŠµì— ìžì£¼ ì‚¬ìš©ëœë‹¤.
> 
> í•™ìŠµë¥ ì„ ì„œì„œížˆ ë‚®ì¶”ëŠ” ê°€ìž¥ ê°„ë‹¨í•œ ë°©ë²•ì€ ë§¤ê°œë³€ìˆ˜'ì „ì²´'ì˜ í•™ìŠµë¥  ê°’ì„ ì¼ê´„ì ìœ¼ë¡œ ë‚®ì¶”ëŠ” ê²ƒì´ë©° ì´ë¥¼ ë”ìš± ë°œì „ì‹œí‚¨ ê²ƒì´ AdaGradì´ë‹¤.
> - AdaGrad ëŠ” 'ê°ê°ì˜' ë§¤ê°œë³€ìˆ˜ì— 'ë§žì¶¤í˜•' ê°’ì„ ë§Œë“¤ì–´ ì¤€ë‹¤.
> 
> AdaGrad ëŠ” ê°œë³„ ë§¤ê°œë³€ìˆ˜ì— ì ì‘ì ìœ¼ë¡œ í•™ìŠµë¥ ì„ ì¡°ì •í•˜ë©´ì„œ í•™ìŠµì„ ì§„í–‰í•œë‹¤. AdaGradì˜ ê°±ì‹  ë°©ë²•ì€ ìˆ˜ì‹ìœ¼ë¡œëŠ” ì•„ëž˜ì™€ ê°™ë‹¤.
> 
> ![AdaGrad_ì‹](./image/06/AdaGrad_ì‹.png)
> 
> 1/âˆšâ„Ž ê³±í•˜ëŠ” ê²ƒì€ ë§¤ê°œë³€ìˆ˜ì˜ ì›ì†Œ ì¤‘ì—ì„œ ë§Žì´ ì›€ì§ì¸(í¬ê²Œ ê°±ì‹ ëœ) ì›ì†ŒëŠ” í•™ìŠµë¥ ì´ ë‚®ì•„ì§„ë‹¤ëŠ” ëœ»
> - í•™ìŠµë¥  ê°ì†Œê°€ ë§¤ê°œ ë³€ìˆ˜ì˜ ì›ì†Œë§ˆë‹¤ ë‹¤ë¥´ê²Œ ì ìš©ë¨
> 
>> AdaGradëŠ” ê³¼ê±°ì˜ ê¸°ìš¸ê¸°ë¥¼ ì œê³±í•˜ì—¬ ê³„ì† ë”í•´ê°„ë‹¤. ê·¸ë¡œì¸í•´ í•™ìŠµì„ ì§„í–‰í•  ìˆ˜ë¡ ê°±ì‹  ê°•ë„ê°€ ì•½í•´ì§€ë©° ë¬´í•œížˆ í•™ìŠµí•œë‹¤ë©´ ì–´ëŠ ìˆœê°„ ê°±ì‹ ëŸ‰ì´ 0ì´ ë˜ì–´ ê°±ì‹ ë˜ì§€ ì•Šê²Œ ëœë‹¤.
>> 
>> ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ê°œì„ í•œ ê¸°ë²•ìœ¼ë¡œ RMSPropì´ë¼ëŠ” ë°©ë²•ì´ ìžˆìœ¼ë©° ì´ ë°©ë²•ì€ ê³¼ì €ì˜ ëª¨ë“  ê¸°ìš¸ê¸°ë¥¼ ê· ì¼í•˜ê²Œ ë”í•´ê°€ëŠ” ê²ƒì´ ì•„ë‹Œ ë¨¼ ê³¼ê±°ì˜ ê¸°ìš¸ê¸°ëŠ” ì„œì„œížˆ ìžŠê³  ìƒˆë¡œìš´ ê¸°ìš¸ê¸° ì •ë³´ë¥¼ í¬ê²Œ ë°˜ì˜í•˜ëŠ” ë°©ë²•ì´ë‹¤.
>> 
>> ë˜í•œ ì´ë¥¼ **ì§€ìˆ˜ì´ë™í‰ê· **ì´ë¼ í•˜ì—¬ ê³¼ê±° ê¸°ìš¸ê¸° ë°˜ì˜ ê·œëª¨ë¥¼ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ê°ì†Œ ì‹œí‚¨ë‹¤.
>
> ì´ì œ AdaGradì˜ ì½”ë“œë¥¼ ì‚´íŽ´ë³¸ë‹¤.
> ```Python
> class AdaGrad:
>   def __init__(self, lr=0.01):
>       self.lr = lr
>       self.h = None
>       
>   def update(self, params, grads):
>       if self.h is None:
>           self.h = {}
>           for key, val in params.items():
>               self.h[key] = np.zeros_like(val)
>           
>       for key in params.keys():
>           self.h[key] += grads[key] * grads[key]
>           params[key] -= self.lr * grads[key] / (np.sqrt(self.h[key]) + 1e-7)
> ```
> ìœ„ ì½”ë“œì—ì„œ ì£¼ì˜í•  ì ì€ ë§ˆì§€ë§‰ ì¤„ì—ì„œ 1e-7ì´ë¼ëŠ” ìž‘ì€ ê°’ì„ ë”í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.
> 
> ì´ ìž‘ì€ ê°’ì€ self.h[key]ì— 0ì´ ë‹´ê²¨ìž‡ë‹¤ í•´ë„ 0ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ì‚¬íƒœë¥¼ ë§‰ì•„ì¤€ë‹¤. ëŒ€ë¶€ë¶„ì˜ ë”¥ëŸ¬ë‹ í”„ë ˆìž„ì›Œí¬ì—ì„œëŠ” ì´ ê°’ë„ ì¸ìˆ˜ë¡œ ì„¤ì •í•  ìˆ˜ ìžˆë‹¤.
> 
> AdaGradë¥¼ ì´ìš©í•´ í’€ë©´ ì•„ëž˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.
> 
> ![AdaGrad_img](./image/06/AdaGrad_img.png)
> 
> ìœ„ ê·¸ë¦¼ì„ ë³´ë©´ ìµœì†Ÿê°’ì„ í–¥í•´ íš¨ìœ¨ì ìœ¼ë¡œ ì›€ì§ì´ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìžˆë‹¤. yì¶• ë°©í–¥ì€ ê¸°ìš¸ê¸°ê°€ ì»¤ì„œ ì²˜ìŒì—” í¬ê²Œ ì›€ì§ì´ì§€ë§Œ í° ì›€ì§ìž„ì— ë¹„ë¡€í•´ ê°±ì‹  ì •ë„ë„ í° í­ìœ¼ë¡œ ìž‘ì•„ì§€ë„ë¡ ì¡°ì •ëœë‹¤.
> 
> ê·¸ëž˜ì„œ yì¶• ë°©í–¥ìœ¼ë¡œ ê°±ì‹ ì˜ ê°•ë„ê°€ ë¹ ë¥´ê²Œ ì•½í•´ì§€ê³  í¬ê·¸ìž¬ê·¸ ì›€ì§ìž„ì´ ì¤„ì–´ë“ ë‹¤.
> 
> #### 6.1.6 Adam
> ê°„ë‹¨ížˆ ë§í•˜ë©´ ëª¨ë©˜í…€ê³¼ AdaGrad ë‘ ê¸°ë²•ì„ ìœµí•©í•œ ê²ƒì´ë¼ ìƒê°í•˜ë©´ ëœë‹¤.
> 
> ì´ë¡ ì€ ë‹¤ì†Œ ë³µìž¡í•˜ì§€ë§Œ ì§ê´€ì ìœ¼ë¡œëŠ” ëª¨ë©˜í…€ê³¼ AdaGradë¥¼ ìœµí•©í•œ ë“¯í•œ ë°©ë²•ì´ë‹¤. ë§¤ê°œë³€ìˆ˜ ê³µê°„ì„ íš¨ìœ¨ì ìœ¼ë¡œ íƒìƒ‰í•´ì¤„ ê²ƒìœ¼ë¡œ ê¸°ëŒ€í•´ë„ ì¢‹ì„ ê²ƒì´ë¼ í•œë‹¤.
> 
> ë˜í•œ í•˜ì´í¼íŒŒë¼ë¯¸í„°ì˜ 'íŽ¸í–¥ ë³´ì •'ì´ ì§„í–‰ëœë‹¤ëŠ” ì ë„ Adamì˜ íŠ¹ì§•ì´ë©° ì±…ì—ì„œëŠ” ë” ê¹Šê²Œ íŒŒê³ ë“¤ì§€ëŠ” ì•ŠëŠ”ë‹¤.
> 
> Adamì„ ì´ìš©í•´ ë¬¸ì œë¥¼ í’€ë©´ ì•„ëž˜ ê·¸ë¦¼ê³¼ ê°™ë‹¤.
> 
> ![Adam_img](./image/06/Adam_img.png)
> 
> Adamì˜ ê°±ì‹  ê³¼ì •ë„ ê·¸ë¦‡ ë°”ë‹¥ì„ êµ¬ë¥´ë“¯ ì›€ì§ì¸ë‹¤. ëª¨ë©˜í…€ê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ ì¢Œìš° í”ë“¤ë¦¼ì´ ì ë‹¤.
> - ì´ëŠ” í•™ìŠµì˜ ê°±ì‹  ê°•ë„ë¥¼ ì ì‘ì ìœ¼ë¡œ ì¡°ì •í•´ì„œ ì–»ëŠ” í˜œíƒì´ë‹¤.
> 
> #### 6.1.7 ì–´ëŠ ê°±ì‹  ë°©ë²•ì„ ì´ìš©í•  ê²ƒì¸ê°€?
> ì§€ê¸ˆê¹Œì§€ í™•ì¸í•œ ê°±ì‹  ë°©ë²• 4ê°œë¥¼ ë¹„êµí•´ë³¸ë‹¤.
> 
> ![6_1_7_1](./image/06/6_1_7_1.png)
> 
> ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ì‚¬ìš©í•œ ê¸°ë²•ì— ë”°ë¼ ê°±ì‹  ê²½ë¡œê°€ ë‹¤ë¥´ë‹¤.
> - ê·¸ë¦¼ë§Œ ë´¤ì„ë• AdaGradê°€ ê°€ìž¥ íš¨ìœ¨ì ìœ¼ë¡œ ë³´ì´ì§€ë§Œ í’€ì–´ì•¼í•  ë¬¸ì œì˜ ì¢…ë¥˜ì™€ (í•™ìŠµë¥  ë“±ì˜)í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì–´ë–»ê²Œ ì„¤ì •í•˜ëŠëƒì— ë”°ë¼ ê²°ê³¼ê°€ ë‹¬ë¼ì§„ë‹¤.
> 
> ê°ê°ì˜ ìƒí™©ì„ ê³ ë ¤í•´ ì„ íƒí•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
> 
> #### 6.1.8 MINST ë°ì´í„°ì…‹ìœ¼ë¡œ ë³¸ ê°±ì‹  ë°©ë²• ë¹„êµ
> ì†ê¸€ì”¨ ìˆ«ìž ì¸ì‹ì„ ëŒ€ìƒìœ¼ë¡œ ì§€ê¸ˆê¹Œì§€ ì„¤ëª…í•œ ë„¤ ê¸°ë²•ì„ ë¹„êµí•´ ë³¸ë‹¤.
> 
> ê° ì¸µì´ 100ê°œì˜ ë‰´ëŸ°ìœ¼ë¡œ êµ¬ì„±ëœ 5ì¸µ ì‹ ê²½ë§ì—ì„œ ReLUë¥¼ í™œì„±í™” í•¨ìˆ˜ë¡œ ì‚¬ìš©í•´ ì¸¡ì •í•œ ê²ƒì´ë‹¤.
> 
> ![MNIST_ê°±ì‹ ë°©ë²•ë¹„êµ](./image/06/MNIST_ê°±ì‹ ë°©ë²•ë¹„êµ.png)
> 
> SGDì˜ í•™ìŠµ ì§„ë„ê°€ ê°€ìž¥ ëŠë¦¬ë©° ë‚˜ë¨¸ì§€ì˜ ì§„ë„ëŠ” ë¹„ìŠ·í•˜ë‹¤(AdaGradê°€ ì¡°ê¸ˆ ë” ë¹¨ë¼ë³´ì¸ë‹¤)
> 
> ì´ ì‹¤í—˜ ë˜í•œ í•˜ì´í¼íŒŒë¼ë¯¸í„°ì¸ í•™ìŠµë¥ ê³¼ ì‹ ê²½ë§ì˜ êµ¬ì¡°(ì¸µ, ê¹Šì´ ë“±)ì— ë”°ë¼ ê²°ê³¼ê°€ ë‹¬ë¼ì§„ë‹¤ëŠ” ì ì´ë‹¤.
> 
> ì¼ë°˜ì ìœ¼ë¡  SGDë³´ë‹¤ ë‹¤ë¥¸ 3ê¸°ë²•ì´ ë¹ ë¥´ê²Œ í•™ìŠµí•˜ë©° ë•Œë¡  ìµœì¢… ì •í™•ë„ë„ ë†’ê²Œ ë‚˜íƒ€ë‚œë‹¤.
> 
> #### 6.2 ê°€ì¤‘ì¹˜ì˜ ì´ˆê¹ƒê°’
> ì‹ ê²½ë§ í•™ìŠµì—ì„œ íŠ¹ížˆ ì¤‘ìš”í•œ ê²ƒì´ ê°€ì¤‘ì¹˜ì˜ ì´ˆê¸°ê°’ì´ë‹¤.
> 
> ê¶Œìž¥ ì´ˆê¹ƒê°’ì— ëŒ€í•´ í•™ìŠµí•œë‹¤.
> 
> #### 6.2.1 ì´ˆê¸°ê°’ì„ 0ìœ¼ë¡œ í•˜ë©´?
> ì˜¤ë²„í”¼íŒ…ì„ ì–µì œí•´ ë²”ìš©ì„±ëŠ¥ì„ ë†’ì´ëŠ” ê¸°ìˆ ì¸ **ê°€ì¤‘ì¹˜ ê°ì†Œ**ê¸°ë²•ì„ í•™ìŠµí•œë‹¤.
> 
> ê°€ì¤‘ì¹˜ ê°ì†ŒëŠ” ê°€ì¤‘ì¹˜ ë§¤ê°œë³€ìˆ˜ì˜ ê°’ì´ ìž‘ì•„ì§€ë„ë¡ í•™ìŠµí•˜ëŠ” ë°©ë²•ì´ë‹¤.
> - ê°€ì¤‘ì¹˜ ê°’ì„ ìž‘ê²Œí•˜ì—¬ ì˜¤ë²„í”¼íŒ…ì´ ì¼ì–´ë‚˜ì§€ ì•Šê²Œ í•˜ëŠ” ê²ƒ.
> 
> ê°€ì¤‘ì¹˜ë¥¼ ìž‘ê²Œ ë§Œë“¤ê³  ì‹¶ìœ¼ë©´ ì´ˆê¹ƒê°’ë„ ìµœëŒ€í•œ ìž‘ì€ ê°’ì—ì„œ ì‹œìž‘í•˜ëŠ” ê²ƒì´ ì •ê³µë²•ì´ì§€ë§Œ ì§€ê¸ˆê¹Œì§€ ê°€ì¤‘ì¹˜ ì´ˆê¹ƒê°’ì€ ```0.01 * np.random.randn(10, 100)```ê³¼ ê°™ì´ ì •ê·œë¶„í¬ì—ì„œ ìƒì„±ë˜ëŠ” ê°’ì„ 0.01ë°° í•œ ìž‘ì€ê°’(í‘œì¤€íŽ¸ì°¨ê°€ 0.01ì¸ ì •ê·œë¶„í¬)ë¥¼ ì‚¬ìš©í–ˆë‹¤.
> 
> ê°€ì¤‘ì¹˜ì˜ ì´ˆê¹ƒê°’ì„ ëª¨ë‘ 0ìœ¼ë¡œ ì„¤ì •í•˜ë©´ í•™ìŠµì´ ì˜¬ë°”ë¡œ ì´ë¤„ì§€ì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤.
> - ì˜¤ì°¨ì—­ì „íŒŒë²•ì—ì„œ ëª¨ë“  ê°€ì¤‘ì¹˜ì˜ ê°’ì´ ë˜‘ê°™ì´ ê°±ì‹ ë˜ê¸° ë•Œë¬¸
> 
>> 2ì¸µ ì‹ ê²½ë§ì—ì„œ ì²« ë²ˆì§¸ì™€ ë‘ ë²ˆì§¸ ì¸µì˜ ê°€ì¤‘ì¹˜ê°€ 0ì´ë¼ê³  ê°€ì •í–ˆì„ ë•Œ
>> 
>> ìˆœì „íŒŒ ë•ŒëŠ” ìž…ë ¥ì¸µì˜ ê°€ì¤‘ì¹˜ê°€ 0ì´ê¸° ë•Œë¬¸ì— ë‘ ë²ˆì§¸ ì¸µì˜ ë‰´ëŸ°ì— ëª¨ë‘ ê°™ì€ ê°’ì´ ì „ë‹¬ ëœë‹¤. ë‘ ë²ˆì§¸ ì¸µì˜ ëª¨ë“  ë‰´ëŸ°ì— ê°™ì€ ê°’ì´ ìž…ë ¥ëœë‹¤ëŠ” ê²ƒì€ ì—­ì „íŒŒ ë•Œ ë‘ ë²ˆì§¸ ì¸µì˜ ê°€ì¤‘ì¹˜ê°€ ëª¨ë‘ ë˜‘ê°™ì´ ê°±ì‹  ëœë‹¤ëŠ” ë§ì´ëœë‹¤.
>> 
>> ë”°ë¼ì„œ ê°€ì¤‘ì¹˜ ë“¤ì€ ê°™ì€ ì´ˆê¹ƒê°’ì—ì„œ ì‹œìž‘í•˜ê³  ê°±ì‹ ì„ ê±°ì³ë„ ì—¬ì „ížˆ ê°™ì€ ê°’ì„ ìœ ì§€í•œë‹¤. ì´ëŠ” ê°€ì¤‘ì¹˜ë¥¼ ì—¬ëŸ¬ ê°œ ê°–ëŠ” ì˜ë¯¸ë¥¼ ì‚¬ë¼ì§€ê²Œ í•œë‹¤.
>> 
>> ì¦‰ 'ê°€ì¤‘ì¹˜ê°€ ê³ ë¥´ê²Œ ë˜ì–´ë²„ë¦¬ëŠ” ìƒí™©'ì„ ë§‰ìœ¼ë ¤ë©´(ê°€ì¤‘ì¹˜ì˜ ëŒ€ì¹­ì ì¸ êµ¬ì¡°ë¥¼ ë¬´ë„ˆëœ¨ë¦¬ë ¤ë©´) ì´ˆê¹ƒê°’ì„ ë¬´ìž‘ìœ„ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤.
>
> #### 6.2.2 ì€ë‹‰ì¸µì˜ í™œì„±í™”ê°’ ë¶„í¬
> ì€ë‹‰ì¸µì˜ í™œì„¤í™”ê°’(í™œì„±í™” í•¨ìˆ˜ì˜ ì¶œë ¥ ë°ì´í„°)ì˜ ë¶„í¬ë¥¼ ê´€ì°°í•´ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìžˆë‹¤.
> 
> ê°€ì¤‘ì¹˜ ì´ˆê¹ƒê°’ì— ë‹¤ë¼ ì€ë‹‰ì¸µ í™œì„±í™”ê°’ë“¤ì´ ì–´ë–»ê²Œ ë³€í™”í•˜ëŠ”ì§€ í™•ì¸í•´ ë³¸ë‹¤
> - í™œì„±í™” í•¨ìˆ˜ë¡œ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” 5ì¸µ ì‹ ê²½ë§ì— ë¬´ìž‘ìœ„ë¡œ ìƒì„±í•œ ìž…ë ¥ ë°ì´í„°ë¥¼ í˜ë ¤ ê° ì¸µì˜ í™œì„±í™”ê°’ ë¶„í¬ë¥¼ ížˆìŠ¤í† ê·¸ëž¨ìœ¼ë¡œ ê·¸ë ¤ë³¸ë‹¤.
> 
> ```Python
> import numpy as np
> import matplotlib.pyplot as plt
> 
> def sigmoid(x):
>     return 1 / (1 + np.exp(-x))
> 
> input_data = np.random.randn(1000, 100)  # 1000ê°œì˜ ë°ì´í„°
> x = input_data
> node_num = 100  # ê° ì€ë‹‰ì¸µì˜ ë…¸ë“œ(ë‰´ëŸ°) ìˆ˜
> hidden_layer_size = 5  # ì€ë‹‰ì¸µì´ 5ê°œ
> activations = {}  # ì´ê³³ì— í™œì„±í™” ê²°ê³¼ë¥¼ ì €ìž¥
> 
> 
> 
> for i in range(hidden_layer_size):
>     if i != 0:
>         x = activations[i-1]
>         
>     w = np.random.randn(node_num, node_num) * 1 # í‘œì¤€ íŽ¸ì°¨ë¥¼ 1ë¡œí•œ ì •ê·œ ë¶„í¬
>     # w = np.random.randn(node_num, node_num) * 0.01 # í‘œì¤€ íŽ¸ì°¨ë¥¼ 0.01ë¡œí•œ ì •ê·œ ë¶„í¬
>     # w = np.random.randn(node_num, node_num) * np.sqrt(1.0 / node_num) # í‘œì¤€ íŽ¸ì°¨ë¥¼ 1ë¡œí•œ ì •ê·œ ë¶„í¬
>     # w = np.random.randn(node_num, node_num) * np.sqrt(2.0 / node_num) # í‘œì¤€ íŽ¸ì°¨ë¥¼ 1ë¡œí•œ ì •ê·œ ë¶„í¬
> ```
> ì¸µì€ 5ê°œê°€ ìžˆìœ¼ë©° ê° ì¸µì˜ ë‰´ëŸ°ì€ 100ê°œì”©ì´ë‹¤. 1000ê°œì˜ ë°ì´í„°ë¥¼ ì •ê·œë¶„í¬ë¥¼ ì´ìš©í•´ ë¬´ìž‘ìœ„ ìƒì„±í•˜ì—¬ ìž…ë ¥í•˜ì—¬ 5ì¸µ ì‹ ê²½ë§ì— í˜ë¦°ë‹¤.
> 
> í™œì„±í™” í•¨ìˆ˜ë¡œëŠ” ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆê³  ê° ì¸µì˜ í™œì„±í™” ê²°ê³¼ë¥¼ activationsë³€ìˆ˜ì— ì €ìž¥í•œë‹¤.
> 
> ì´ ì½”ë“œì—ì„  ê°€ì¤‘ì¹˜ì˜ ë¶„í¬ì— ì£¼ì˜í•´ì•¼ í•œë‹¤.
> 
> ë¶„í¬ëœ ì •ë„(í‘œì¤€íŽ¸ì°¨)ë¥¼ ë°”ê¿”ê°€ë©° ì–´ë–»ê²Œ ë³€í™”í•˜ëŠ”ì§€ ížˆìŠ¤í† ê·¸ëž¨ìœ¼ë¡œ ê·¸ë ¤ë³¸ë‹¤.
> 
> ```Python
> for i, a in activations.items():
>     plt.subplot(1, len(activations), i+1)
>     plt.title(str(i+1) + "-layer")
>     if i != 0: plt.yticks([], [])
>     # plt.xlim(0.1, 1)
>     # plt.ylim(0, 7000)
>     plt.hist(a.flatten(), 30, range=(0,1))
> plt.show()
> ```
> wì˜ ê°’ë§Œ ë°”ê¿”ê°€ë©° ìœ„ ì½”ë“œë¥¼ ì´ìš©í•´ ížˆìŠ¤í† ê·¸ëž¨ì„ ì¶œë ¥í•œë‹¤.
> 
> ì•„ëž˜ì˜ ížˆìŠ¤í† ê·¸ëž¨ì€ ```w = np.random.randn(node_num, node_num) * 1```ì¼ë•Œ (í‘œì¤€íŽ¸ì°¨ê°€ 1ì¸ ì •ê·œë¶„í¬)ì˜ ížˆìŠ¤í† ê·¸ëž¨ì´ë‹¤.
> 
> ![í‘œì¤€íŽ¸ì°¨ê°€_1ì¸_ì •ê·œë¶„í¬](./image/06/í‘œì¤€íŽ¸ì°¨ê°€_1ì¸_ì •ê·œë¶„í¬.png)
> 
> ê° ì¸µì˜ í™œì„±í™” ê°’ë“¤ì´ 0ê³¼ 1ì— ì¹˜ìš°ì³ ë¶„í¬ë˜ì–´ ìžˆë‹¤. 
> 
> ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ëŠ” ì¶œë ¥ì´ 0ì— ê°€ê¹Œì›Œì§€ìž(ë˜ëŠ” 1ì— ê°€ê¹Œì›Œì§€ìž)ê·¸ ë¯¸ë¶„ì€ 0ì— ë‹¤ê°€ê°„ë‹¤ ê·¸ë¡œì¸í•´ ë°ì´í„°ê°€ 0ê³¼ 1ì— ì¹˜ìš°ì³ ë¶„í¬í•˜ê²Œ ë˜ë©´ ì—­ì „íŒŒì˜ ê¸°ìš¸ê°€ ê°’ì´ ì ì  ìž‘ì•„ì§€ë‹¤ê°€ ì‚¬ë¼ì§„ë‹¤.
> - ì´ë¥¼ **ê¸°ìš¸ê¸° ì†Œì‹¤**ì´ë¼ í•œë‹¤. ì¸µì„ ê¹Šê²Œí•˜ëŠ” ë”¥ëŸ¬ë‹ì—ì„  ê¸°ìš¸ê¸° ì†Œì‹¤ì€ ë” ì‹¬ê°í•œ ë¬¸ì œê°€ ë  ìˆ˜ ìžˆë‹¤.
> 
> ì•„ëž˜ì˜ ížˆìŠ¤í† ê·¸ëž¨ì€ ```w = np.random.randn(node_num, node_num) * 0.01```ì¼ë•Œ, í‘œì¤€íŽ¸ì°¨ê°€ 0.01ì¸ ì •ê·œë¶„í¬ì¼(std = 0.01)ì˜ ížˆìŠ¤í† ê·¸ëž¨ì´ë‹¤.
> 
> ![í‘œì¤€íŽ¸ì°¨ê°€_0_01ì¸_ì •ê·œë¶„í¬](./image/06/í‘œì¤€íŽ¸ì°¨ê°€_0_01ì¸_ì •ê·œë¶„í¬.png)
> 
> ì´ë²ˆì—” 0.5 ë¶€ê·¼ì— ì§‘ì¤‘ë˜ì–´ ìžˆë‹¤. ê¸°ìš¸ê¸° ì†Œì‹¤ ë¬¸ì œëŠ” ë°œìƒí•˜ì§€ ì•Šì•˜ì§€ë§Œ í™œì„±í™”ê°’ë“¤ì´ ì¹˜ìš°ì³¤ë‹¤ëŠ” ê²ƒì€ í‘œí˜„ë ¥ ê´€ì ì—ì„œ í° ë¬¸ì œê°€ ìžˆë‹¤.
> - ë‹¤ìˆ˜ì˜ ë‰´ëŸ°ì´ ê±°ì˜ ê°™ì€ ê°’ì„ ì¶œë ¥í•˜ë©´ ë‰´ëŸ°ì„ ì—¬ëŸ¬ê°œ ë‘” ì˜ë¯¸ê°€ ì—†ì–´ì§„ë‹¤ëŠ” ëœ»ì´ë‹¤.
> 
> í™œì„±í™” ê°’ë“¤ì´ ì¹˜ìš°ì¹˜ë©´ **í‘œí˜„ë ¥ì„ ì œí•œ**í•œë‹¤ëŠ” ê´€ì ì—ì„œ ë¬¸ì œê°€ ëœë‹¤.
> 
>> ê° ì¸µì˜ í™œì„±í™” ê°’ë“¤ì€ ì ì ˆížˆ ë¶„í¬ë˜ì–´ì•¼ í•œë‹¤. ì¸µê³¼ ì¸µ ì‚¬ì´ì— ì ë‹¹í•˜ê²Œ ë‹¤ì–‘í•œ ë°ì´í„°ê°€ íë¥´ê²Œ í•´ì•¼ ì‹ ê²½ë§ í•™ìŠµì´ íš¨ìœ¨ì ìœ¼ë¡œ ì´ë¤„ì§€ê¸° ë•Œë¬¸ì´ë‹¤.
>> 
>> ë°˜ëŒ€ë¡œ ì¹˜ìš°ì¹œ ë°ì´í„°ê°€ íë¥´ë©´ ê¸°ìš¸ê¸° ì†Œì‹¤ì´ë‚˜ í‘œí˜„ë ¥ ì œí•œ ë¬¸ì œì— ë¹ ì ¸ í•™ìŠµì´ ìž˜ ì´ë¤„ì§€ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìƒê¸´ë‹¤.
>> 
> ì´ë²ˆì—” ì‚¬ë¹„ì—ë¥´ ê¸€ë¡œë¡œíŠ¸ì™€ ìš”ìŠˆì•„ ë²¤ì§€ì˜¤ì˜ ë…¼ë¬¸ì—ì„œ ê¶Œìž¥í•˜ëŠ” **Xavier ì´ˆê¹ƒê°’**ì„ ì‚¬ìš©í•´ ë³¸ë‹¤.
> - í˜„ìž¬ ì¼ë°˜ì ì¸ ë”¥ëŸ¬ë‹ í”„ë ˆìž„ì›Œí¬ë“¤ì´ í‘œì¤€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìžˆë‹¤.
>
>> í•´ë‹¹ ë…¼ë¬¸ì€ ê° ì¸µì˜ í™œì„±í™” ê°’ë“¤ì„ ê´‘ë²”ìœ„ í•˜ê²Œ ë¶„í¬ì‹œí‚¬ ëª©ì ìœ¼ë¡œ ê°€ì¤‘ì¹˜ì˜ ì ì ˆí•œ ë¶„í¬ë¥¼ ì°¾ê³ ìž í–ˆìœ¼ë©° ì•ž ê³„ì¸µì˜ ë…¸ë“œê°€ nê°œë¼ë©´ í‘œì¤€íŽ¸ì°¨ê°€ 1/âˆšnì¸ ë¶„í¬ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤ëŠ” ê²°ë¡ ì„ ì´ëŒì—ˆë‹¤.
>> 
>> ![Xavier](./image/06/Xavier.png)
>> 
>> Xavierì´ˆê¹ƒê°’ì„ ì‚¬ìš©í•˜ë©´ ì•ž ì¸µì— ë…¸ë“œê°€ ë§Žì„ìˆ˜ë¡ ëŒ€ìƒ ë…¸ë“œì˜ ì´ˆê¹ƒê°’ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê°€ì¤‘ì¹˜ê°€ ì¢ê²Œ í¼ì§„ë‹¤.
>
> ì•„ëž˜ì˜ ížˆìŠ¤í† ê·¸ëž¨ì€ ```w = np.random.randn(node_num, node_num) * np.sqrt(1.0 / node_num)``` Xavierì´ˆê¹ƒê°’ì„ ì´ìš©í•  ë•Œì˜ ížˆìŠ¤í† ê·¸ëž¨ì´ë‹¤.
> - ```w = np.random.randn(node_num, node_num) / np.sqrt(node_num)``` ê°™ì€ ì‹ì´ë‹¤.
> 
> ![Xavier_hist](./image/06/Xavier_hist.png)
> 
> ê²°ê³¼ë¥¼ ë³´ë©´ ì¸µì´ ê¹Šì–´ì§€ë©´ì„œ í˜•íƒœê°€ ë‹¤ì†Œ ì¼ê·¸ëŸ¬ì§€ì§€ë§Œ ì•žì—ì„œ ë³¸ ë°©ì‹ë“¤ ë³´ë‹¤ ë„“ê²Œ ë¶„í¬ë¨ì„ ì•Œ ìˆ˜ ìžˆë‹¤.
> 
> ê° ì¸µì— íë¥´ëŠ” ë°ì´í„°ëŠ” ì ë‹¹ížˆ í¼ì ¸ ìžˆìœ¼ë¯€ë¡œ, ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ì˜ í‘œí˜„ë ¥ë„ ì œí•œë°›ì§€ ì•Šê³  í•™ìŠµì´ íš¨ìœ¨ì ìœ¼ë¡œ ì´ë¤„ì§ˆ ê²ƒìœ¼ë¡œ ê¸°ëŒ€ëœë‹¤.
> 
>> ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ì¼ê·¸ëŸ¬ì§€ëŠ” í˜„ìƒì€ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ ëŒ€ì‹  tanh í•¨ìˆ˜(ìŒê³¡ì„  í•¨ìˆ˜)ë¥¼ ì‚¬ìš©í•˜ë©´ ê°œì„ ëœë‹¤. 
>> 
>> tanhí•¨ìˆ˜ë„ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ì™€ ê°™ì´ Sìž ëª¨ì–‘ì˜ ê³¡ì„  í•¨ìˆ˜ë‹¤ tanhí•¨ìˆ˜ëŠ” ì›ì ì—ì„œ ëŒ€ì¹­ì¸ Sê³¡ì„ ì´ì§€ë§Œ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ëŠ” (0, 0.5)ì—ì„œ ëŒ€ì¹­ì¸ Sê³¡ì„ ì´ë‹¤.
>> 
>> í™œì„±í™” í•¨ìˆ˜ìš©ìœ¼ë¡  ì›ì ì—ì„œ ëŒ€ì¹­ì¸ í•¨ìˆ˜ê°€ ë°”ëžŒì§í•˜ë‹¤ê³  í•œë‹¤.
>> 
> #### 6.2.3 ReLUë¥¼ ì‚¬ìš©í•  ë•Œì˜ ê°€ì¤‘ì¹˜ ì´ˆê¹ƒê°’.
> Xavierì´ˆê¹ƒê°’ì€ í™œì„±í™” í•¨ìˆ˜ê°€ ì„ í˜•ì¸ ê²ƒì„ ì „ì œë¡œ ì´ëˆ ê²°ê³¼ë‹¤.
> - ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ì™€ tanh í•¨ìˆ˜ëŠ” ì¢Œìš° ëŒ€ì¹­ì´ë¼ ì¤‘ì•™ ë¶€ê·¼ì´ ì„ í˜•ì¸ í•¨ìˆ˜ë¡œ ë³¼ ìˆ˜ ìžˆìœ¼ë¯€ë¡œ Xavierì´ˆê¹ƒê°’ì´ ì ë‹¹í•˜ë‹¤.
> 
> í•˜ì§€ë§Œ ReLU í•¨ìˆ˜ë¥¼ ì´ìš©í•  ë• ReLUí•¨ìˆ˜ì— íŠ¹í™”ëœ ì´ˆê¹ƒê°’ì„ ì´ìš©í•˜ë¼ê³  ê¶Œìž¥í•œë‹¤.
> - **He ì´ˆê¹ƒê°’**
> 
> He ì´ˆê¹ƒê°’ì€ ì•ž ê³„ì¸µì˜ ë…¸ë“œê°€ nê°œì¼ ë•Œ í‘œì¤€íŽ¸ì°¨ê°€ âˆš(2/n)ì¸ ì •ê·œë¶„í¬ë¥¼ ì‚¬ìš©í•œë‹¤(XavierëŠ” âˆš(1/n)ì´ì˜€ë‹¤.)
> - ReLUëŠ” ìŒì˜ ì˜ì—­ì´ 0ì´ ì•„ë‹ˆë¼ ë” ë„“ê²Œ ë¶„í¬ì‹œí‚¤ê¸° ìœ„í•´ 2ë°°ì˜ ê³„ìˆ˜ê°€ í•„ìš”í•˜ë‹¤ê³  í•´ì„í•  ìˆ˜ ìžˆë‹¤.
> 
> ì•„ëž˜ëŠ” í™œì„±í™” í•¨ìˆ˜ë¡œ ReLUë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ í‘œì¤€íŽ¸ì°¨ê°€ 0.01ì¸ ì •ê·œë¶„í¬, Xavier ì´ˆê¹ƒê°’, He ì´ˆê¹ƒê°’ì¼ë•Œì˜ ê²°ê³¼ë‹¤.
> 
>  ```w = np.random.randn(node_num, node_num) * 0.01```ì¼ë•Œ, í‘œì¤€íŽ¸ì°¨ê°€ 0.01ì¸ ì •ê·œë¶„í¬ì¼(std = 0.01)ì˜ ížˆìŠ¤í† ê·¸ëž¨ì´ë‹¤.
>  
> ![ReLU_001](./image/06/ReLU_001.png)
> 
> ```w = np.random.randn(node_num, node_num) * np.sqrt(1.0 / node_num)``` Xavierì´ˆê¹ƒê°’ì„ ì´ìš©í•  ë•Œì˜ ížˆìŠ¤í† ê·¸ëž¨ì´ë‹¤.
> - ```w = np.random.randn(node_num, node_num) / np.sqrt(node_num)``` ê°™ì€ ì‹ì´ë‹¤.
> 
> ![ReLU_Xavier](./image/06/ReLU_Xavier.png)
>
> ```w = np.random.randn(node_num, node_num) * np.sqrt(2.0 / node_num)``` Heì´ˆê¹ƒê°’ì„ ì´ìš©í•  ë•Œì˜ ížˆìŠ¤í† ê·¸ëž¨ì´ë‹¤.
> - ```w = np.random.randn(node_num, node_num) / np.sqrt(node_num)``` ê°™ì€ ì‹ì´ë‹¤. 
> 
> ![ReLU_He](./image/06/ReLU_He.png)
> 
> ê²°ê³¼ë¥¼ ë³´ë©´ í‘œì¤€íŽ¸ì°¨ê°€ 0.01ì¸ ì •ê·œë¶„í¬ì¼(std = 0.01)ë•Œ ê° ì¸µì˜ í™œì„±í™”ê°’ë“¤ì€ ì•„ì£¼ ìž‘ì€ ê°’ë“¤ì´ë‹¤.
> 
> ì‹ ê²½ë§ì—ì„œ ì•„ì£¼ ìž‘ì€ ë°ì´í„°ê°€ íë¥¸ë‹¤ëŠ” ê²ƒì€ ì—­ì „íŒŒ ë•Œ ê°€ì¤‘ì¹˜ ê¸°ìš¸ê¸° ì—­ì‹œ ìž‘ì•„ì§„ë‹¤ëŠ” ëœ»ì´ë‹¤.
> - ì‹¤ì œë¡œ í•™ìŠµì´ ê±°ì˜ ì´ë¤„ì§€ì§€ ì•Šì„ ê²ƒ
> 
> Xavier ì´ˆê¹ƒê°’ì˜ ê²°ê³¼ëŠ” ì¸µì´ ê¹Šì–´ì§€ë©° ì¹˜ìš°ì¹¨ì´ ì»¤ì§„ë‹¤. ì‹¤ì œë¡œ ì¸µì´ ê¹Šì–´ì§€ë©´ í™œì„±í™” ê°’ë“¤ì˜ ì¹˜ìš°ì¹¨ë„ ì»¤ì§€ê³  í•™ìŠµí•  ë•Œ 'ê¸°ìš¸ê¸° ì†Œì‹¤'ë¬¸ì œë¥¼ ì¼ìœ¼í‚¨ë‹¤.
> 
> He ì´ˆê¹ƒê°’ì€ ëª¨ë“  ì¸µì—ì„œ ê· ì¼í•˜ê²Œ ë¶„í¬ ë˜ì—ˆë‹¤. ì¸µì´ ê¹Šì–´ì ¸ë„ ë¶„í¬ê°€ ê· ì¼í•˜ê²Œ ìœ ì§€ë˜ì–´ ì—­ì „íŒŒ ë•Œì—ë„ ì ì ˆí•œ ê°’ì´ ë‚˜ì˜¬ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.
> 
> í™œì„±í™” í•¨ìˆ˜ë¡œ ReLUë¥¼ ì‚¬ìš©í•  ë• Heì´ˆê¹ƒê°’ì„, ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ ë˜ëŠ” tanh ë“±ì˜ Sìž ëª¨ì–‘ ê³¡ì„ ì¼ ë•ŒëŠ” Xavier ì´ˆê¹ƒê°’ì„ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤ê³  ìƒê°ëœë‹¤.
> 
> #### 6.2.4 MNIST ë°ì´í„° ì…‹ìœ¼ë¡œ ë³¸ ê°€ì¤‘ì¹˜ ì´ˆê¹ƒê°’ ë¹„êµ
> MNISTë°ì´í„° ì…‹ì„ ì´ìš©í•´ ì‹ ê²½ë§ í•™ìŠµì— ì–¼ë§ˆë‚˜ ì˜í–¥ì„ ì£¼ëŠ”ì§€ í™•ì¸í•´ ë³¸ë‹¤. ê²°ê³¼ëŠ” ì•„ëž˜ ê·¸ë¦¼ê³¼ ê°™ë‹¤.
> - std = 0.01, Xavier ì´ˆê¹ƒê°’, He ì´ˆê¹ƒê°’
> 
> ![MNIST_ê°€ì¤‘ì¹˜ì´ˆê¹ƒê°’_ë¹„êµ](./image/06/MNIST_ê°€ì¤‘ì¹˜ì´ˆê¹ƒê°’_ë¹„êµ.png)
> 
> ì¸µë³„ ë‰´ëŸ° ìˆ˜ê°€ 100ê°œì¸ 5ì¸µ ì‹ ê²½ë§ì—ì„œ ReLUí•¨ìˆ˜ë¥¼ í™œì„±í™” í•¨ìˆ˜ë¡œ ì‚¬ìš©í•˜ì˜€ë‹¤.
> 
> std = 0.01ì¼ ë•ŒëŠ” í•™ìŠµì´ ì „í˜€ ì´ë¤„ì§€ì§€ ì•ŠëŠ”ë‹¤. ìˆœì „íŒŒ ë•Œ ë„ˆë¬´ ìž‘ì€ ê°’(0ì˜ ê·¼ì²˜ë¡œ ë°€ì§‘í•œ ë°ì´í„°)ê°€ íë¥´ê¸° ë•Œë¬¸ì´ë‹¤
> - ì—­ì „íŒŒ ë•Œì˜ ê¸°ìš¸ê¸°ë„ ìž‘ì•„ì ¸ ê°€ì¤‘ì¹˜ê°€ ê±°ì˜ ê°±ì‹ ë˜ì§€ ì•ŠëŠ”ë‹¤.
> 
> Xavierì™€ He ì´ˆê¹ƒê°’ì˜ ê²½ìš°ëŠ” í•™ìŠµì´ ì •ìƒì ìœ¼ë¡œ ì´ë¤„ì§„ë‹¤ í•˜ì§€ë§Œ í•™ìŠµì˜ ì§„ë„ëŠ” Heì´ˆê¹ƒê°’ìª½ì´ ë” ë¹ ë¥´ë‹¤.
> 
> ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ê²ƒê³¼ ê°™ì´ ê°€ì¤‘ì¹˜ ì´ˆê¹ƒê°’ì€ ì‹ ê²½ë§ í•™ìŠµì— ì¤‘ìš”í•œ í¬ì¸íŠ¸ë‹¤. 
> 
> ê°€ì¤‘ì¹˜ ì´ˆê¹ƒê°’ì— ë”°ë¼ í•™ìŠµì˜ ì„±íŒ¨ê°€ ê°ˆë¦¬ëŠ” ê²½ìš°ê°€ ë§Žê¸° ë•Œë¬¸ì´ë‹¤.
> 
> #### 6.3 ë°°ì¹˜ ì •ê·œí™”
> ê°€ì¤‘ì¹˜ ì´ˆê¹ƒê°’ì„ ì ì ˆížˆ ì„¤ì •í•˜ë©´ ê° ì¸µì˜ í™œì„±í™”ê°’ ë¶„í¬ê°€ ì ë‹¹ížˆ í¼ì§€ë©´ì„œ í•™ìŠµì´ ì›í™œí•˜ê²Œ ìˆ˜í–‰ë¨ì„ í•™ìŠµí–ˆë‹¤.
> 
> ì´ë²ˆì—” ê° ì¸µì´ í™œì„±í™”ë¥¼ ì ë‹¹ížˆ í¼ëœ¨ë¦¬ë„ë¡ 'ê°•ì œ'í•´ë³¸ë‹¤.
> 
> **ë°°ì¹˜ ì •ê·œí™”**ë¥¼ í•™ìŠµí•œë‹¤.
> 
> #### 6.3.1 ë°°ì¹˜ ì •ê·œí™” ì•Œê³ ë¦¬ì¦˜
> ë°°ì¹˜ ì •ê·œí™”ëŠ” 2015ë…„ì— ì œì•ˆëœ ì–¼ë§ˆ ì•ˆëœ ë°©ë²•ì´ì§€ë§Œ ë§Žì€ ì‚¬ëžŒë“¤ì´ ì‚¬ìš©í•œë‹¤.
> - ì‹¤ì œë¡œ ë°°ì¹˜ ì •ê·œí™”ë¥¼ ì´ìš©í•´ ë›°ì–´ë‚œ ê²°ê³¼ë¥¼ ë‹¬ì„±í•œ ì˜ˆê°€ ë§Žë‹¤.
> 
> ë°°ì¹˜ ì •ê·œí™”ëŠ” ì•„ëž˜ì˜ íŠ¹ì„±ìœ¼ë¡œ ì¸í•´ ì£¼ëª©ë°›ëŠ”ë‹¤.
>> - **í•™ìŠµì„ ë¹¨ë¦¬ ì§„í–‰í•  ìˆ˜ ìžˆë‹¤(í•™ìŠµ ì†ë„ ê°œì„ )**
>> 
>> - **ì´ˆê¹ƒê°’ì— í¬ê²Œ ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤(ì´ˆê¹ƒê°’ ì„ íƒ ê³ ë¯¼ X)**
>> 
>> - **ì˜¤ë²„í”¼íŒ…ì„ ì–µì œí•œë‹¤(ë“œë¡­ì•„ì›ƒ ë“±ì˜ í•„ìš”ì„± ê°ì†Œ)**
> 
> ë°°ì¹˜ ì •ê·œí™”ì˜ ê¸°ë³¸ ì•„ì´ë””ì–´ëŠ” ê° ì¸µì—ì„œ í™œì„±í™”ê°’ì´ ì ë‹¹ížˆ ë¶„í¬ë˜ë„ë¡ ì¡°ì • í•˜ëŠ” ê²ƒì´ë‹¤.
> 
> ì•„ëž˜ ê·¸ë¦¼ê³¼ ê°™ì´ ë°ì´í„° ë¶„í¬ë¥¼ ì •ê·œí™”í•˜ëŠ” 'ë°°ì¹˜ ì •ê·œí™” ê³„ì¸µ'ì„ ì‹ ê²½ë§ì— ì‚½ìž…í•œë‹¤. 
> 
> ![ë°°ì¹˜_ì •ê·œí™”_ì‹ ê²½ë§_ì˜ˆ](./image/06/ë°°ì¹˜_ì •ê·œí™”_ì‹ ê²½ë§_ì˜ˆ.png)
> 
> ë°°ì¹˜ ì •ê·œí™”ëŠ” í•™ìŠµ ì‹œ ë¯¸ë‹ˆë°°ì¹˜ë¥¼ ë‹¨ìœ„ë¡œ ì •ê·œí™”í•œë‹¤.
> 
> êµ¬ì²´ì ìœ¼ë¡  ë°ì´í„° ë¶„í¬ê°€ í‰ê· ì´ 0, ë¶„ì‚°ì´ 1ì´ ë˜ë„ë¡ ì •ê·œí™” í•œë‹¤. ìˆ˜ì‹ì€ ì•„ëž˜ì™€ ê°™ë‹¤.
> 
> ![ì‹6_7](./image/06/ì‹6_7.png)
> 
> ë˜ ë°°ì¹˜ ì •ê·œí™” ê³„ì¸µë§ˆë‹¤ ì´ ì •ê·œí™”ëœ ë°ì´í„°ì— ê³ ìœ í•œ í™•ëŒ€(scale)ì™€ ì´ë™(shift)ë³€í™˜ì„ ìˆ˜í–‰í•œë‹¤. ìˆ˜ì‹ìœ¼ë¡œëŠ” ì•„ëž˜ì™€ ê°™ë‹¤.
>
> ![ì‹6_8](./image/06/ì‹6_8.png)
> 
> ì´ìƒì´ ë°°ì¹˜ ì •ê·œí™”ì˜ ì•Œê³ ë¦¬ì¦˜ì´ë©° ì´ ì•Œê³ ë¦¬ì¦˜ì´ ì‹ ê²½ë§ ìˆœì „íŒŒë•Œ ì ìš©ëœë‹¤.
> 
> ì´ë¥¼ ê³„ì‚°ê·¸ëž˜í”„ë¡œ ê·¸ë¦°ë‹¤ë©´ ì•„ëž˜ì™€ ê°™ì´ ê·¸ë¦´ ìˆ˜ ìžˆë‹¤.
>
> ![ë°°ì¹˜_ì •ê·œí™”_ê³„ì‚°_ê·¸ëž˜í”„](./image/06/ë°°ì¹˜_ì •ê·œí™”_ê³„ì‚°_ê·¸ëž˜í”„.png) 
>
> #### 6.3.2 ë°°ì¹˜ ì •ê·œí™”ì˜ íš¨ê³¼
> MNISTë°ì´í„° ì…‹ì„ ì‚¬ìš©í•´ ë°°ì¹˜ ì •ê·œí™” ê³„ì¸µì„ ì‚¬ìš©í•  ë•Œì™€ ì‚¬ìš©í•˜ì§€ ì•Šì„ ë•Œì˜ í•™ìŠµ ì§„ë„ê°€ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ í™•ì¸í•œë‹¤.
> 
> ![6_18](./image/06/6_18.png) 
>
> ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ë°°ì¹˜ ì •ê·œí™”ê°€ í•™ìŠµì„ ë¹¨ë¦¬ ì§„ì „ ì‹œí‚¨ë‹¤.
> 
> ê³„ì†í•´ì„œ ì´ˆê¹ƒê°’ ë¶„í¬ë¥¼ ë‹¤ì–‘í•˜ê²Œ ì„¤ì •í•˜ë©° í•™ìŠµ ì§„í–‰ì´ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ í™•ì¸í•œë‹¤.
> 
> ì•„ëž˜ ê·¸ë¦¼ì€ ê°€ì¤‘ì¹˜ ì´ˆê¹ƒê°’ì˜ í‘œì¤€íŽ¸ì°¨ë¥¼ ë‹¤ì–‘í•˜ê²Œ ë°”ê¿”ê°€ë©° í•™ìŠµ ê²½ê³¼ë¥¼ ê´€ì°°í•œ ê·¸ëž˜í”„ë‹¤.
> 
> ![ë°°ì¹˜_ì •ê·œí™”_ë‹¤ì–‘í•œ_í‘œì¤€íŽ¸ì°¨](./image/06/ë°°ì¹˜_ì •ê·œí™”_ë‹¤ì–‘í•œ_í‘œì¤€íŽ¸ì°¨.png) 
> 
> ê±°ì˜ ëª¨ë“  ê²½ìš°ì—ì„œ ë°°ì¹˜ ì •ê·œí™”ë¥¼ ì‚¬ìš©í•  ë•Œ í•™ìŠµ ì§„ë„ê°€ ë¹ ë¥¸ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚œë‹¤.
> 
> ì‹¤ì œë¡œ ë°°ì¹˜ ì •ê·œí™”ë¥¼ ì´ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì—” ì´ˆê¹ƒê°’ì´ ìž˜ ë¶„í¬ë˜ì–´ ìžˆì§€ ì•Šìœ¼ë©´ í•™ìŠµì´ ì§„í–‰ë˜ì§€ ì•ŠëŠ” ëª¨ìŠµë„ ìžˆë‹¤.
> 
> ì§€ê¸ˆê¹Œì§€ ë³¸ ê²ƒê³¼ ê°™ì´ ë°°ì¹˜ ì •ê·œí™”ë¥¼ ì‚¬ìš©í•˜ë©´ í•™ìŠµì´ ë¹¨ë¼ì§€ê³  ê°€ì¤‘ì¹˜ ì´ˆê¹ƒê°’ì— í¬ê²Œ ì˜ì¡´í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
> 
> 05/07
